"use strict";(globalThis.webpackChunkengineering_playbook=globalThis.webpackChunkengineering_playbook||[]).push([[9457],{5663:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"infrasec/certs","title":"SSL Certificates","description":"SSL Certificates are most commonly used to verify a server\'s identity and","source":"@site/docs/infrasec/certs.md","sourceDirName":"infrasec","slug":"/infrasec/certs","permalink":"/docs/infrasec/certs","draft":false,"unlisted":false,"editUrl":"https://github.com/trussworks/Engineering-Playbook/edit/main/docs/infrasec/certs.md","tags":[],"version":"current","frontMatter":{},"sidebar":"practices","previous":{"title":"Project Bootstrap Guide","permalink":"/docs/infrasec/bootstrap"},"next":{"title":"InfraSec Practice Charter","permalink":"/docs/infrasec/charter"}}');var s=n(4848),a=n(8453);const i={},o="SSL Certificates",c={},l=[{value:"Getting a real certificate",id:"getting-a-real-certificate",level:2},{value:"Let&#39;s Encrypt",id:"lets-encrypt",level:3},{value:"SSLMate",id:"sslmate",level:3},{value:"External resources",id:"external-resources",level:2}];function d(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"ssl-certificates",children:"SSL Certificates"})}),"\n",(0,s.jsxs)(t.p,{children:["SSL Certificates are most commonly used to verify a server's identity and\nencrypt HTTP traffic. Usually, we try to use offerings like Amazon's\n",(0,s.jsx)(t.a,{href:"https://aws.amazon.com/certificate-manager/",children:"AWS Certificate Manager"})," to\neliminate the toil of obtaining certificates and keeping them up to date."]}),"\n",(0,s.jsx)(t.p,{children:"However, this isn't always feasible. Sometimes we can use self-signed\ncertificates if it will not be exposed to users (for instance, to encrypt\nthe connection between containers and their ALB), but in many cases we'll\nneed to get a real certificate."}),"\n",(0,s.jsxs)(t.p,{children:["Note: TLS (",(0,s.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Transport_Layer_Security",children:"Transport Layer Security"}),')\nis essentially the second generation of SSL. It is not uncommon for both\nterms to be used interchangeably at this point, but "real" SSL is\ndeprecated. Any modern systems should be using TLS.']}),"\n",(0,s.jsx)(t.h2,{id:"getting-a-real-certificate",children:"Getting a real certificate"}),"\n",(0,s.jsx)(t.h3,{id:"lets-encrypt",children:"Let's Encrypt"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.a,{href:"https://letsencrypt.org/",children:"Let's Encrypt"})," provides free short-lifetime\ncertificates; they also provide a daemon which can autorenew these\ncertificates if you are running on actual hosts (or full instances) where\nrunning an additional daemon makes sense. However, this doesn't work\nfor many of our use cases, where we are trying to run our applications in\nbare containers."]}),"\n",(0,s.jsx)(t.h3,{id:"sslmate",children:"SSLMate"}),"\n",(0,s.jsxs)(t.p,{children:["If you need to get a certificate and cannot use a service like ACM or\nLet's Encrypt, you can get one via ",(0,s.jsx)(t.a,{href:"https://sslmate.com/",children:"SSLMate"}),"; they\noffer a command line client that makes it relatively easy to get new\ncertificates or update old ones, autorenewal, and a reasonable price for\none-off certificates. Their documentation is\n",(0,s.jsx)(t.a,{href:"https://sslmate.com/help/",children:"here"})," but the general process is this:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Register a new account with SSLMate; save the username and password\nto 1Password for your project."}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Install the SSLMate client:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-console",children:"$ brew install sslmate\n"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Generate a new certificate. If you just need a cert for a single\ndomain, this should be just:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-console",children:"$ mkdir ~/sslmate\n$ cd ~/sslmate\n$ sslmate buy example.com --approval=dns\n"})}),"\n",(0,s.jsx)(t.p,{children:"This will prompt you for your SSLMate username and password, and\nask you to confirm your order. Once you do, it will provide you with\na DNS record you need to create to verify you have access to this\ndomain. Create this record (usually via Terraform) and then continue\nthis workflow."}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Once your certificate has been validated, ",(0,s.jsx)(t.code,{children:"sslmate"})," will dump a key,\na certificate, an intermediate CA certificate, and a combined server\nchain certificate into your current directory. You will probably only\nneed the first two; everything but the key can be later retrieved from\nSSLMate if you need to. ",(0,s.jsx)(t.em,{children:"The key only exists where you generated the\nkey"})," (so, your laptop) -- make sure you put this somewhere safe (like\nthe AWS Parameter Store); if you lose it you will need to regenerate\nthe key and the certs."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["The easiest way to pass these certificates to your application is\nlikely via the AWS Parameter Store using ",(0,s.jsx)(t.code,{children:"chamber"}),", but it may vary for\nyour project. To add it to the Parameter Store with ",(0,s.jsx)(t.code,{children:"chamber"}),", you can\nuse a command similar to this one:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-console",children:'$ aws-vault exec my-aws-profile -- chamber write "app-myapp-myenv" server-cert - < example.com.crt\n$ aws-vault exec my-aws-profile -- chamber write "app-myapp-myenv" server-key - < example.com.key\n'})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"external-resources",children:"External resources"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["How an SSL/TLS handshake works: ",(0,s.jsx)(t.a,{href:"https://www.ssl.com/article/ssl-tls-handshake-overview/",children:"https://www.ssl.com/article/ssl-tls-handshake-overview/"})]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>o});var r=n(6540);const s={},a=r.createContext(s);function i(e){const t=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);