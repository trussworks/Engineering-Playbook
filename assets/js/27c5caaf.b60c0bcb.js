"use strict";(self.webpackChunkengineering_playbook=self.webpackChunkengineering_playbook||[]).push([[3214],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=p(n),h=o,m=u["".concat(s,".").concat(h)]||u[h]||d[h]||r;return n?a.createElement(m,i(i({ref:t},c),{},{components:n})):a.createElement(m,i({ref:t},c))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var p=2;p<r;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},4623:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var a=n(7462),o=(n(7294),n(3905));const r={},i="Frontend Architecture",l={unversionedId:"web/frontend/architecture",id:"web/frontend/architecture",title:"Frontend Architecture",description:"Selecting a version of Node.js",source:"@site/docs/web/frontend/architecture.md",sourceDirName:"web/frontend",slug:"/web/frontend/architecture",permalink:"/docs/web/frontend/architecture",draft:!1,editUrl:"https://github.com/trussworks/Engineering-Playbook/edit/main/docs/web/frontend/architecture.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Front End",permalink:"/docs/web/frontend/"},next:{title:"Developer Experience",permalink:"/docs/web/frontend/developer-experience"}},s={},p=[{value:"Selecting a version of Node.js",id:"selecting-a-version-of-nodejs",level:2},{value:"Directory Structure",id:"directory-structure",level:2},{value:"Application Bootstrap",id:"application-bootstrap",level:3},{value:"(or, how does all of this come together?)",id:"or-how-does-all-of-this-come-together",level:4},{value:"Application State &amp; Data Management",id:"application-state--data-management",level:2},{value:"Local state vs. API data?",id:"local-state-vs-api-data",level:3}],c={toc:p};function d(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"frontend-architecture"},"Frontend Architecture"),(0,o.kt)("h2",{id:"selecting-a-version-of-nodejs"},"Selecting a version of Node.js"),(0,o.kt)("p",null,"When starting a new project, you will want to select an Active LTS release of Node.js and make plans to move to the next LTS release after it becomes active and before the selected release goes out of maintenance. You could choose a \u201ccurrent\u201d release but there is a good chance that the libraries you want to use have not been tested until it becomes active. Odd-numbered releases are short-lived, so only choose one intentionally. (For instance, if some library you want to use doesn't work in an LTS release.) Please refer to this ",(0,o.kt)("a",{parentName:"p",href:"https://nodejs.org/en/about/releases/"},"release schedule")," to make your selection."),(0,o.kt)("p",null,"Once you have done this, you may want to enforce it by configuring the ",(0,o.kt)("inlineCode",{parentName:"p"},"engines")," key in your project\u2019s package.json file. For instance, if you have selected 12.x, you might want to add this section:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'# package.json\n"engines": {\n  "node": "^12"\n}\n')),(0,o.kt)("p",null,"You may also want to create team recommendations for how your team manages their local version of node.js. For instance, you could recommend they use ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/nodenv/nodenv"},"nodenv")," or ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/nvm-sh/nvm"},"nvm")," and provide configuration to keep it on the release path you want."),(0,o.kt)("h2",{id:"directory-structure"},"Directory Structure"),(0,o.kt)("p",null,"This is a suggested directory structure for your frontend application. It's not a hard requirement and you may end up using some, all, or none of these suggestions based on your project needs. Generally it's a good idea to be intentional about how you organize frontend code, separate code by concerns, and avoid coupling multiple functions or systems together (ie, React code, Redux code, native JS, etc.)."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"/src/components")," - Low-level ",(0,o.kt)("strong",{parentName:"p"},"React Components")," that are more about rendering UI than handling application logic, and should typically ",(0,o.kt)("em",{parentName:"p"},"not")," be connected to providers directly. Aim for abstract, generic components that can be shared across the application easily, and will usually have corresponding ",(0,o.kt)("inlineCode",{parentName:"p"},"stories")," files for viewing in Storybook.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"/src/config")," - High-level configuration definitions relevant to the whole application (such as routes).")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"/src/constants")," - Define constants here instead of using string literals for any values with specific meaning in the context of the application. For example, data that comes back from the API that may be used in UI logic (such as a user role or casefile status).")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"/src/containers")," - ",(0,o.kt)("strong",{parentName:"p"},"React Components")," that are primarily concerned with connecting UI to containers or providers (such as Redux), and sharing behavior or patterns via hooks or higher-order components.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"/src/content")," - Content that ends up displayed in the UI to the end-user. This is often expressed as plain text, but can also include JSX nodes in order to support formatted text. An example is defining how specific values from API data should be displayed as user-friendly language.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"/src/graphql")," - GraphQL code is in here! (but not all of it!)"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"/src/graphql/fragments")," - Common GraphQL fragments that may be shared across queries/mutations.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"/src/graphql/mocks")," - Not to be confused with testing mocks. This defines client-only schema and resolvers for GraphQL requests that have not yet been implemented in the API.")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"/src/helpers")," - Miscellaneous utilities that implement logic, data handling, and other common functions used throughout the application. These should not include React-specific code such as JSX, and they should generally be purely functional and well-tested.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"/src/layout")," - ",(0,o.kt)("strong",{parentName:"p"},"React components")," used to render common layout elements, such as header, footer, page content, etc. Similar to the components located in ",(0,o.kt)("inlineCode",{parentName:"p"},"/src/components"),", they should focus on rendering UI rather than application logic or connecting to providers. However, they are designed such that there should only ever be one instance on each page.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"/src/pages")," - ",(0,o.kt)("strong",{parentName:"p"},"React components")," that correspond to actual routes (URLs). These are responsible for assembling the UI components for a page, and hooking them up with the necessary providers such as Redux or GraphQL. Queries should be co-located with page components, since pages are explicitly dependent on them.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"/src/store")," - Redux or other application state management code is in here! For more info on whether to use Redux or GraphQL, ",(0,o.kt)("a",{parentName:"p",href:"#to-redux-or-graphql"},"read here"),"."),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"/src/store/store.ts")," - Configures and exports the Redux store"),(0,o.kt)("li",{parentName:"ul"},'Directories in here correspond to reducers, or "slices" of the store. Each directory contains its own types, actions, and reducer. These should all be well-tested.'))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"/src/stories")," - Storybook stories that aren't specific to a single component live here.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"/src/styles")," - Sometimes we also have to write CSS.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"/src/types")," - Type definitions that are shared throughout the application."))),(0,o.kt)("h3",{id:"application-bootstrap"},"Application Bootstrap"),(0,o.kt)("h4",{id:"or-how-does-all-of-this-come-together"},"(or, how does all of this come together?)"),(0,o.kt)("p",null,"The primary entry point is ",(0,o.kt)("inlineCode",{parentName:"p"},"src/index.tsx"),". This file is responsible for:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"(if using GraphQL) Initializing ApolloClient with our configuration and any client-side mocks."),(0,o.kt)("li",{parentName:"ul"},"Including the CSS entry point (",(0,o.kt)("inlineCode",{parentName:"li"},"src/index.scss"),") so it doesn't feel left out, and so our webpages look pretty."),(0,o.kt)("li",{parentName:"ul"},"Wrapping the main ",(0,o.kt)("inlineCode",{parentName:"li"},"<App />")," component inside of top-level providers, such as ",(0,o.kt)("inlineCode",{parentName:"li"},"<ApolloProvider>")," (GraphQL), ",(0,o.kt)("inlineCode",{parentName:"li"},"<Provider>")," (Redux), and ",(0,o.kt)("inlineCode",{parentName:"li"},"<PersistGate>")," (redux-persist)."),(0,o.kt)("li",{parentName:"ul"},"Finally, rendering the resulting ",(0,o.kt)("inlineCode",{parentName:"li"},"<App />")," component into the DOM (!!)")),(0,o.kt)("p",null,"The next most important file is ",(0,o.kt)("inlineCode",{parentName:"p"},"src/App.tsx"),". This is the top-level component that is rendered into the DOM. It is responsible for 2 important things:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Imposing a global ",(0,o.kt)("inlineCode",{parentName:"li"},"<Layout />")," onto ",(0,o.kt)("em",{parentName:"li"},"all pages"),"."),(0,o.kt)("li",{parentName:"ul"},"Mapping whatever the current route is to the matching page component. If there is no matching page component, it will render the ",(0,o.kt)("inlineCode",{parentName:"li"},"NotFound")," page component instead.")),(0,o.kt)("h2",{id:"application-state--data-management"},"Application State & Data Management"),(0,o.kt)("p",null,"Choosing a method of state management for your application will depend a lot on the project\u2019s needs, and how much & what kind of data is being cached from an API or is just being set and stored locally. Some common options are:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://reactjs.org/docs/context.html"},"React Context")," - built-in to React, \u201ccontext provides a way to pass data through the component tree without having to pass props down manually at every level\u201d"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://redux.js.org/"},"Redux")," - client-side global state management and action dispatch, can persist to local storage and also use with ",(0,o.kt)("a",{parentName:"li",href:"https://redux-saga.js.org/"},"Redux-Saga")," to control complex logic flows and side effects"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://www.apollographql.com/docs/react/"},"Apollo Client")," - caching API data for projects that are interacting with a GraphQL API"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://react-query.tanstack.com/"},"React Query")," - similar API to ApolloClient but can be used with any kind of API (including REST)")),(0,o.kt)("h3",{id:"local-state-vs-api-data"},"Local state vs. API data?"),(0,o.kt)("p",null,"A lot of confusion can stem from where to store data and how to access it in React applications. An important thing to consider is whether the data is saved in a database, or if it represents local ephemeral state. In other words: does it need to be re-hydrated if the user refreshes their window? Here are some things to consider:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Avoid using Redux to cache API data, as this will require a lot of manual handling to make associations for relational data, and knowing when to update or re-fetch resources. If you are using a GraphQL API, we recommend using ",(0,o.kt)("a",{parentName:"li",href:"https://www.apollographql.com/docs/react/"},"ApolloClient"),", and if you aren't then try out ",(0,o.kt)("a",{parentName:"li",href:"https://react-query.tanstack.com/"},"React Query"),". Both of these tools are very smart at caching, so when we get API data we don't need to store it anywhere else! Storing API data in Redux in addition to Apollo or ReactQuery would be redundant."),(0,o.kt)("li",{parentName:"ul"},"React Context and Redux are useful for storing local application state. That means any UI state that the entire application needs to be aware of, but that ",(0,o.kt)("em",{parentName:"li"},"doesn't")," need to be saved to a database for later. Examples include the current page URL, and whether or not a full page modal is open. They can also be useful for storing mock data that will eventually come from the API, but hasn't been implemented yet.")))}d.isMDXComponent=!0}}]);