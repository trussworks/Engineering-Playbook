"use strict";(self.webpackChunkengineering_playbook=self.webpackChunkengineering_playbook||[]).push([[1722],{3905:(e,t,r)=>{r.d(t,{Zo:()=>l,kt:()=>f});var a=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var c=a.createContext({}),m=function(e){var t=a.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},l=function(e){var t=m(e.components);return a.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),p=m(r),f=n,d=p["".concat(c,".").concat(f)]||p[f]||u[f]||o;return r?a.createElement(d,i(i({ref:t},l),{},{components:r})):a.createElement(d,i({ref:t},l))}));function f(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=p;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var m=2;m<o;m++)i[m]=r[m];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}p.displayName="MDXCreateElement"},3435:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>m});var a=r(7462),n=(r(7294),r(3905));r(8209);const o={},i="`terraform state mv` in Delicate Circumstances",s={unversionedId:"infrasec/terraform/terraform-state-mv",id:"infrasec/terraform/terraform-state-mv",title:"`terraform state mv` in Delicate Circumstances",description:"Sometimes you have a preexisting resource that you'd like to replace with another version. That's why the terraform state mv command exists. The Terraform documentation will give you an outline of the different circumstances in which you can use it (including when moving resource between state files).",source:"@site/docs/infrasec/terraform/terraform-state-mv.md",sourceDirName:"infrasec/terraform",slug:"/infrasec/terraform/terraform-state-mv",permalink:"/docs/infrasec/terraform/terraform-state-mv",draft:!1,editUrl:"https://github.com/trussworks/Engineering-Playbook/edit/main/docs/infrasec/terraform/terraform-state-mv.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"terraform import",permalink:"/docs/infrasec/terraform/terraform-import"},next:{title:"Terratest Guide",permalink:"/docs/infrasec/terraform/terratest"}},c={},m=[{value:"Steps",id:"steps",level:2},{value:"Complications",id:"complications",level:2},{value:"Resources",id:"resources",level:2}],l={toc:m};function u(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},l,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"terraform-state-mv-in-delicate-circumstances"},(0,n.kt)("inlineCode",{parentName:"h1"},"terraform state mv")," in Delicate Circumstances"),(0,n.kt)("p",null,"Sometimes you have a preexisting resource that you'd like to replace with another version. That's why the ",(0,n.kt)("inlineCode",{parentName:"p"},"terraform state mv")," command exists. The ",(0,n.kt)("a",{parentName:"p",href:"https://www.terraform.io/docs/commands/state/mv.html"},"Terraform documentation")," will give you an outline of the different circumstances in which you can use it (including when moving resource between state files)."),(0,n.kt)("h2",{id:"steps"},"Steps"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Add the new instance of the resource (or the module it lives in)."),(0,n.kt)("li",{parentName:"ol"},"Run ",(0,n.kt)("inlineCode",{parentName:"li"},"terraform state mv")," with the appropriate arguments."),(0,n.kt)("li",{parentName:"ol"},"Delete the initial instance."),(0,n.kt)("li",{parentName:"ol"},"Run ",(0,n.kt)("inlineCode",{parentName:"li"},"terraform plan")," to ensure you don't have a remaining resource.")),(0,n.kt)("h2",{id:"complications"},"Complications"),(0,n.kt)("p",null,"Sometimes you will be wary about running state move because you aren't sure that your move makes sense (i.e. in the case of a clean plan but dirty apply). In that case, you can safeguard by first ",(0,n.kt)("a",{parentName:"p",href:"https://www.terraform.io/docs/commands/state/pull.html"},"pulling state locally")," and then moving. If your plan goes sideways, you can revert to the earlier state via ",(0,n.kt)("a",{parentName:"p",href:"https://www.terraform.io/docs/commands/state/push.html"},"state push"),"."),(0,n.kt)("h2",{id:"resources"},"Resources"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://www.terraform.io/docs/commands/state/index.html"},"Terraform state commands")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://medium.com/@lynnlin827/moving-terraform-resources-states-from-one-remote-state-to-another-c76f8b76a996"},"Terraform moving across across different state files"))))}u.isMDXComponent=!0},8209:(e,t,r)=>{r(7294)}}]);