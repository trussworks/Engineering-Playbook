"use strict";(globalThis.webpackChunkengineering_playbook=globalThis.webpackChunkengineering_playbook||[]).push([[1664],{7082:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"developing/languages/ruby/installation","title":"Installation","description":"Context","source":"@site/docs/developing/languages/ruby/installation.md","sourceDirName":"developing/languages/ruby","slug":"/developing/languages/ruby/installation","permalink":"/docs/developing/languages/ruby/installation","draft":false,"unlisted":false,"editUrl":"https://github.com/trussworks/Engineering-Playbook/edit/main/docs/developing/languages/ruby/installation.md","tags":[],"version":"current","frontMatter":{},"sidebar":"about","previous":{"title":"Ruby","permalink":"/docs/developing/languages/ruby/"},"next":{"title":"Learning Resources","permalink":"/docs/developing/learning/"}}');var i=s(4848),r=s(8453);const o={},t="Installation",a={},d=[{value:"Context",id:"context",level:2},{value:"The Trussel Way",id:"the-trussel-way",level:2},{value:"Setup Instructions",id:"setup-instructions",level:3},{value:"Install Prerequisites",id:"install-prerequisites",level:4},{value:"Install <code>asdf</code>",id:"install-asdf",level:4},{value:"Install asdf-ruby",id:"install-asdf-ruby",level:4},{value:"Enable a specific Ruby version",id:"enable-a-specific-ruby-version",level:4},{value:"Verify that it worked",id:"verify-that-it-worked",level:4},{value:"Install bundler",id:"install-bundler",level:4},{value:"What to do if you already have RVM or rbenv",id:"what-to-do-if-you-already-have-rvm-or-rbenv",level:3},{value:"Uninstall RVM",id:"uninstall-rvm",level:4},{value:"Uninstall rbenv",id:"uninstall-rbenv",level:4},{value:"Using Ruby via Docker",id:"using-ruby-via-docker",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"installation",children:"Installation"})}),"\n",(0,i.jsx)(n.h2,{id:"context",children:"Context"}),"\n",(0,i.jsx)(n.p,{children:"Although macOS ships with Ruby, it is not recommended to use it for development\nfor several reasons:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"It is usually an older version, and is only updated as part of a major macOS\nrelease."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Installing gems in the system Ruby requires the use of ",(0,i.jsx)(n.code,{children:"sudo"}),". In general, it\nshould be assumed that everything under ",(0,i.jsx)(n.code,{children:"/System/Library"})," is part of macOS and\nis administered by Apple. Files in those directories should not be modified."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"the-trussel-way",children:"The Trussel Way"}),"\n",(0,i.jsx)(n.p,{children:"We recommend installing and managing Ruby using asdf."}),"\n",(0,i.jsx)(n.p,{children:"It's also possible to use Docker, instructions for which are at the bottom of this document."}),"\n",(0,i.jsx)(n.h3,{id:"setup-instructions",children:"Setup Instructions"}),"\n",(0,i.jsxs)(n.p,{children:["If you don't have a specific project in mind, install the ",(0,i.jsx)(n.a,{href:"https://www.ruby-lang.org/en/news/",children:"latest version that has been released"})," and then configure that to be the global default version."]}),"\n",(0,i.jsxs)(n.p,{children:["If you are planning to work on a specific project, you'll need to know what version of Ruby that project requires. The convention is for this to be defined in a project's ",(0,i.jsx)(n.code,{children:"Gemfile"}),". Look for a line that looks like this:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ruby",children:'ruby "~> 3.1.2"\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In the above example, any version of Ruby in the range ",(0,i.jsx)(n.code,{children:"3.1.2"})," to ",(0,i.jsx)(n.code,{children:"3.1.99999"})," will suffice."]}),"\n",(0,i.jsx)(n.h4,{id:"install-prerequisites",children:"Install Prerequisites"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Install ",(0,i.jsx)(n.a,{href:"https://brew.sh/",children:"Homebrew"})]}),"\n",(0,i.jsxs)(n.li,{children:["Install Apple Command Line Tools using ",(0,i.jsx)(n.code,{children:"xcode-select --install"})]}),"\n"]}),"\n",(0,i.jsxs)(n.h4,{id:"install-asdf",children:["Install ",(0,i.jsx)(n.code,{children:"asdf"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://asdf-vm.com",children:"asdf"})," is a program that manages multiple language versions. It uses language-specific plugins to define the specifics for each language it supports. We'll be using ",(0,i.jsx)(n.a,{href:"https://github.com/asdf-vm/asdf-ruby",children:"the officially supported plugin for Ruby"})," in this guide."]}),"\n",(0,i.jsx)(n.p,{children:"Install asdf using homebrew:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-console",children:"$ brew install asdf\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Then, configure your shell to load asdf. The following instructions are for ZSH (the default shell in macOS); for other shells or OSes, find the relevant section in ",(0,i.jsx)(n.a,{href:"https://asdf-vm.com/guide/getting-started.html#_3-install-asdf",children:"the asdf installation documentation"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-console",children:'$ echo -e "\\n. $(brew --prefix asdf)/libexec/asdf.sh" >> ${ZDOTDIR:-~}/.zshrc\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Close your shell and open a new one. Type ",(0,i.jsx)(n.code,{children:"asdf"})," and you should see something like the following:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-console",children:"$ asdf\nversion: v0.10.2\n\nMANAGE PLUGINS\nasdf plugin add <name> [<git-url>]      Add a plugin from the plugin repo OR,\n                                        add a Git repo as a plugin by\n                                        specifying the name and repo url\n\n...\n"})}),"\n",(0,i.jsx)(n.p,{children:"If that is working, continue on to the next step."}),"\n",(0,i.jsx)(n.h4,{id:"install-asdf-ruby",children:"Install asdf-ruby"}),"\n",(0,i.jsx)(n.p,{children:"To add support for Ruby to asdf, add the plugin:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-console",children:"$ asdf plugin add ruby https://github.com/asdf-vm/asdf-ruby.git\n"})}),"\n",(0,i.jsx)(n.p,{children:"Then ensure that you have a build environment setup to install Ruby. We're using the pre-built OpenSSL from homebrew as it more reliably installs than other options:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-console",children:'$ export RUBY_CONFIGURE_OPTS="--with-openssl-dir=$(brew --prefix openssl@1.1)"\n'})}),"\n",(0,i.jsx)(n.p,{children:"Then you can install the specific version of Ruby you identified earlier:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-console",children:"$ asdf install ruby 3.1.2\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This command will install the ",(0,i.jsx)(n.a,{href:"https://github.com/rbenv/ruby-build",children:"ruby-build"})," tool, which it will then use to compile and setup the version of Ruby specified. This will take a few minutes. If you have issues, ",(0,i.jsx)(n.a,{href:"https://github.com/rbenv/ruby-build/wiki#troubleshooting",children:"the ruby-build documentation"})," has some helpful tips."]}),"\n",(0,i.jsx)(n.p,{children:"Close your terminal and open another one to reload the Ruby configuration."}),"\n",(0,i.jsx)(n.h4,{id:"enable-a-specific-ruby-version",children:"Enable a specific Ruby version"}),"\n",(0,i.jsx)(n.p,{children:"Once you have installed a version of Ruby, you'll want to set that as the version for use by your project."}),"\n",(0,i.jsxs)(n.p,{children:["To set the version to use within the current directory (which will be stored in a ",(0,i.jsx)(n.code,{children:".tool-versions"})," file):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-console",children:"$ asdf local ruby 3.1.2\n"})}),"\n",(0,i.jsx)(n.p,{children:"To set the version to use globally by default (handy for ad-hoc use):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-console",children:"$ asdf global ruby 3.1.2\n"})}),"\n",(0,i.jsx)(n.h4,{id:"verify-that-it-worked",children:"Verify that it worked"}),"\n",(0,i.jsxs)(n.p,{children:["First, make sure that the ",(0,i.jsx)(n.code,{children:"ruby"})," command is being resolved to one provided by asdf:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-console",children:"$ which ruby\n/Users/<USERNAME>/.asdf/shims/ruby\n"})}),"\n",(0,i.jsxs)(n.p,{children:["If you see something like ",(0,i.jsx)(n.code,{children:"/usr/bin/ruby"}),", then your shell isn't picking up your asdf configuration."]}),"\n",(0,i.jsx)(n.p,{children:"Check that you have the correct Ruby installed:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-console",children:"$ ruby --version\nruby 3.1.2p20 (2022-04-12 revision 4491bb740a) [x86_64-darwin21]\n"})}),"\n",(0,i.jsx)(n.h4,{id:"install-bundler",children:"Install bundler"}),"\n",(0,i.jsx)(n.p,{children:"Almost all Ruby projects will need bundler installed. You can do that with:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-console",children:"$ gem install bundler\n"})}),"\n",(0,i.jsxs)(n.p,{children:["At this point, you can probably switch over to your project's setup instructions. They will usually start off by telling you to run ",(0,i.jsx)(n.code,{children:"bundle install"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"what-to-do-if-you-already-have-rvm-or-rbenv",children:"What to do if you already have RVM or rbenv"}),"\n",(0,i.jsx)(n.p,{children:"We recommend uninstalling them before running the script."}),"\n",(0,i.jsx)(n.h4,{id:"uninstall-rvm",children:"Uninstall RVM"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"rvm implode\n"})}),"\n",(0,i.jsx)(n.p,{children:"Other directories that might need to be removed:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"~/.rvm"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"~/.rvmrc"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/etc/rvm"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Remove any ",(0,i.jsx)(n.code,{children:"RVM"}),"-related lines from the following files:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"~/.bashrc"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"~/.bash_profile"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"~/.profile"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"~/.zshrc"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"~/.zprofile"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"~/.zshenv"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Quit and relaunch Terminal/iTerm"}),"\n",(0,i.jsx)(n.h4,{id:"uninstall-rbenv",children:"Uninstall rbenv"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"rm -rf ~/.rbenv\n"})}),"\n",(0,i.jsx)(n.p,{children:"or"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"brew uninstall rbenv\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Remove any ",(0,i.jsx)(n.code,{children:"rbenv"}),"-related lines from the following files:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"~/.bashrc"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"~/.bash_profile"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"~/.profile"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"~/.zshrc"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"~/.zprofile"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"~/.zshenv"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Quit and relaunch Terminal/iTerm"}),"\n",(0,i.jsx)(n.h3,{id:"using-ruby-via-docker",children:"Using Ruby via Docker"}),"\n",(0,i.jsx)(n.p,{children:"Using Docker makes sense if :"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"You don't use Ruby regularly, and only need it occasionally, such as to\nreview candidate work samples"}),"\n",(0,i.jsx)(n.li,{children:"You don't want to install anything locally"}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/trussworks/Engineering-Playbook/tree/master/developing/docker#installation",children:"Install Docker"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"cd"})," into the directory of the Ruby project you want to work with"]}),"\n",(0,i.jsxs)(n.li,{children:["Run a bash shell in Docker: ",(0,i.jsx)(n.code,{children:"docker run -it --rm=true -v $PWD:$PWD -w $PWD ruby:${DESIRED_RUBY_VERSION}-slim bash"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"For example, if you want an image with Ruby 2.6.4, you would run:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"docker run -it --rm=true -v $PWD:$PWD -w $PWD ruby:2.6.4-slim bash\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>t});var l=s(6540);const i={},r=l.createContext(i);function o(e){const n=l.useContext(r);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),l.createElement(r.Provider,{value:n},e.children)}}}]);