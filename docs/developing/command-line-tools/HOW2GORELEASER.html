<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-developing/command-line-tools/HOW2GORELEASER">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Building internal tools with GoReleaser | Truss Engineering Playbook</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://playbook.truss.dev/docs/developing/command-line-tools/HOW2GORELEASER"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Building internal tools with GoReleaser | Truss Engineering Playbook"><meta data-rh="true" name="description" content="Overview"><meta data-rh="true" property="og:description" content="Overview"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://playbook.truss.dev/docs/developing/command-line-tools/HOW2GORELEASER"><link data-rh="true" rel="alternate" href="https://playbook.truss.dev/docs/developing/command-line-tools/HOW2GORELEASER" hreflang="en"><link data-rh="true" rel="alternate" href="https://playbook.truss.dev/docs/developing/command-line-tools/HOW2GORELEASER" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.20d7de8d.css">
<link rel="preload" href="/assets/js/runtime~main.06f11dc9.js" as="script">
<link rel="preload" href="/assets/js/main.1bc8baa5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/truss-icon-light.png" alt="Truss Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/truss-icon-light.png" alt="Truss Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Engineering Playbook</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">About</a><a class="navbar__item navbar__link" href="/docs/practices">Practices</a><a class="navbar__item navbar__link" href="/docs/incident-response">Incident Response</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/trussworks/Engineering-Playbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">Engineering Playbook</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/documentation/intro-to-docs">Introduction to Documentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/documentation/adr">Architectural Decision Records</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/documentation/external-resources">External Resources</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/compliance">Federal Compliance</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/developing">Developing</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developing">Tools and Practice</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developing/bugs">Defects/Bugs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/developing/cicd">CI/CD</a><button aria-label="Toggle the collapsible sidebar category &#x27;CI/CD&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/developing/code-reviews">Code Reviews</a><button aria-label="Toggle the collapsible sidebar category &#x27;Code Reviews&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/developing/command-line-tools">Command Line Tools</a><button aria-label="Toggle the collapsible sidebar category &#x27;Command Line Tools&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/developing/command-line-tools/HOW2GORELEASER">Building internal tools with GoReleaser</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developing/command-line-tools/direnv">direnv</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developing/command-line-tools/docker">Docker</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developing/configuration">Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developing/cycle">Development Cycle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developing/eid">Editors, IDEs and Debuggers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developing/growth">Growth</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developing/healthcheck">Health Checks</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/developing/languages">Programming Languages</a><button aria-label="Toggle the collapsible sidebar category &#x27;Programming Languages&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/developing/learning">Learning Resources</a><button aria-label="Toggle the collapsible sidebar category &#x27;Learning Resources&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/developing/nix">nix</a><button aria-label="Toggle the collapsible sidebar category &#x27;nix&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/developing/open-source">Open Source</a><button aria-label="Toggle the collapsible sidebar category &#x27;Open Source&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/developing/pairing">Pair Programming</a><button aria-label="Toggle the collapsible sidebar category &#x27;Pair Programming&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developing/slack">Slack Best Practices</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/developing/technical-design">Technical Design</a><button aria-label="Toggle the collapsible sidebar category &#x27;Technical Design&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/developing/vcs">Source Control</a><button aria-label="Toggle the collapsible sidebar category &#x27;Source Control&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/leadership">Leadership</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/web">Web Development</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Developing</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/developing/command-line-tools"><span itemprop="name">Command Line Tools</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Building internal tools with GoReleaser</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Building internal tools with GoReleaser</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><p>This is a biased document for how to build and release tools written in go.</p><p>If someone else has already written a tool and open sourced it use it and contribute to it.</p><p>Feel free to update and make changes!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="install-goreleaser">Install GoReleaser<a href="#install-goreleaser" class="hash-link" aria-label="Direct link to Install GoReleaser" title="Direct link to Install GoReleaser">​</a></h2><p>To install GoReleaser visit the <a href="https://goreleaser.com/install/" target="_blank" rel="noopener noreferrer">installation instructions</a>. It can be installed
with brew if you use:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token plain">brew install goreleaser/tap/goreleaser</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">brew install goreleaser</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="split-a-tool-out-from-an-existing-project">Split a tool out from an existing project<a href="#split-a-tool-out-from-an-existing-project" class="hash-link" aria-label="Direct link to Split a tool out from an existing project" title="Direct link to Split a tool out from an existing project">​</a></h2><p>If you are splitting a tool from an existing project, you can follow the
instructions in <a href="/docs/developing/vcs/git-repos#splitting-out-code-to-a-new-repository">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="get-the-project-building-binaries">Get the project building binaries<a href="#get-the-project-building-binaries" class="hash-link" aria-label="Direct link to Get the project building binaries" title="Direct link to Get the project building binaries">​</a></h2><p>This assumes you are creating a binary from a Go project.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="generate-a-gomod-file">Generate a <code>go.mod</code> file<a href="#generate-a-gomod-file" class="hash-link" aria-label="Direct link to generate-a-gomod-file" title="Direct link to generate-a-gomod-file">​</a></h3><p>Your project may not have a <code>go.mod</code> file already, you can skip ahead if so.</p><p>Initializes your <code>go.mod</code> file with your current version of Go:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token plain">go mod init github.com/OWNER/NEWREPO</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Fills out your <code>go.mod</code> and <code>go.sum</code> files and builds your binary for your current OS:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token plain">go build</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You might run into some issues getting this to work outside of a project you may have split this code from. Spend some time getting it to build.</p><p>When you feel good about it, add <code>go.mod</code> and <code>go.sum</code> to your git index with a commit.</p><p><a href="https://medium.com/mindorks/create-projects-independent-of-gopath-using-go-modules-802260cdfb51" target="_blank" rel="noopener noreferrer">Blog post I used to figure this out</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="add-pre-commit-hooks">Add pre-commit hooks<a href="#add-pre-commit-hooks" class="hash-link" aria-label="Direct link to Add pre-commit hooks" title="Direct link to Add pre-commit hooks">​</a></h2><p>Write a <code>.pre-commit-config.yaml</code> file and add it to git with a commit.
Then install the hooks and run the hooks against all files for the first time.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token plain">pre-commit install --install-hooks</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">pre-commit run --all-files</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Fix any issues you find and commit your changes to your repo.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-pre-commit-configyaml-and-markdownlintrc">Example .pre-commit-config.yaml and .markdownlintrc<a href="#example-pre-commit-configyaml-and-markdownlintrc" class="hash-link" aria-label="Direct link to Example .pre-commit-config.yaml and .markdownlintrc" title="Direct link to Example .pre-commit-config.yaml and .markdownlintrc">​</a></h3><p>The following example <code>.pre-commit-config.yaml</code> does some nice things for a basic go project.
Ensure you&#x27;re using the latest versions of these tools by running <code>pre-commit autoupdate</code> and
checking in changes to source control.</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token key atrule" style="color:#728fcb">repos</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">repo</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain">//github.com/golangci/golangci</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">lint</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">rev</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> v1.51.2</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">hooks</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">id</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> golangci</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">lint</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token key atrule" style="color:#728fcb">entry</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> golangci</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">lint run </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">fix </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">timeout 300s</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">repo</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain">//github.com/pre</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">commit/pre</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">commit</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">hooks</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">rev</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> v4.4.0</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">hooks</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">id</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> check</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">merge</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">conflict</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">id</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> check</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">yaml</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">id</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> detect</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">private</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">key</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">id</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> trailing</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">whitespace</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">repo</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain">//github.com/igorshubovych/markdownlint</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">cli</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">rev</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> v0.33.0</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">hooks</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">id</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> markdownlint</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">repo</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain">//github.com/trussworks/pre</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">commit</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">hooks</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">rev</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> v1.1.1</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">hooks</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">id</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> goreleaser</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">check</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This example <code>.markdownlintrc</code> will work with the above <code>.pre-commit-config.yaml</code> example.
This ignores some stylistic but annoying triggers.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token property" style="color:#b29762">&quot;default&quot;</span><span class="token operator" style="color:#063289">:</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token property" style="color:#b29762">&quot;first-header-h1&quot;</span><span class="token operator" style="color:#063289">:</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">false</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token property" style="color:#b29762">&quot;first-line-h1&quot;</span><span class="token operator" style="color:#063289">:</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">false</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token property" style="color:#b29762">&quot;line_length&quot;</span><span class="token operator" style="color:#063289">:</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">false</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token property" style="color:#b29762">&quot;no-multiple-blanks&quot;</span><span class="token operator" style="color:#063289">:</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">false</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token property" style="color:#b29762">&quot;fenced-code-language&quot;</span><span class="token operator" style="color:#063289">:</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-docker-configuration">Create Docker configuration<a href="#create-docker-configuration" class="hash-link" aria-label="Direct link to Create Docker configuration" title="Direct link to Create Docker configuration">​</a></h2><p>Suggested but optional. This is just another distribution method.</p><p>Create a <code>Dockerfile</code> at the root of your repo and commit it to git.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-dockerfile">Example Dockerfile<a href="#example-dockerfile" class="hash-link" aria-label="Direct link to Example Dockerfile" title="Direct link to Example Dockerfile">​</a></h3><p>This example is a very basic Dockerfile that works with goreleaser with a tool/binary name of <code>binaryname</code>.</p><p>Goreleaser will use the binary it determines is correct to copy into the container.</p><div class="language-docker codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-docker codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token plain">FROM alpine:3</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">COPY binaryname /bin/binaryname</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">ENTRYPOINT [ &quot;binaryname&quot; ]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-docker-repo">Create a Docker repo<a href="#create-a-docker-repo" class="hash-link" aria-label="Direct link to Create a Docker repo" title="Direct link to Create a Docker repo">​</a></h2><p>Create a Docker repo. There&#x27;s Docker Hub, ECR, and GitHub.
You&#x27;ll need to be sure to enable automation to push into whatever you use.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-docker-hub-repo">Create a Docker Hub repo<a href="#create-a-docker-hub-repo" class="hash-link" aria-label="Direct link to Create a Docker Hub repo" title="Direct link to Create a Docker Hub repo">​</a></h3><p>We don&#x27;t use the trussworks Docker Hub org very much so you&#x27;ll need to reach out to the #infrasec Slack channel to find someone to help you.</p><p>Log into <a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer">Docker Hub</a> with your personal account. If you don&#x27;t have an account then make one
and then have someone on InfraSec add you to the Trussworks organization.</p><p><a href="https://hub.docker.com/repository/create" target="_blank" rel="noopener noreferrer">Create a new Docker Hub repo</a> following the same naming convention of the
repo like <code>trussworks/NEWREPO</code>. You should be able to select <code>trussworks</code> from a drop down on the form. Then set
the name to the same name as your tool or github repository name. The repository should be <code>Public</code> and not <code>Private</code>
if it is an open-source tool.</p><p>After creating the repo configure the permissions to allow the <code>bots</code> user group to have <code>Read &amp; Write</code>
access to that repo.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="get-an-api-key-for-pushing-the-docker-image">Get an API key for pushing the docker image<a href="#get-an-api-key-for-pushing-the-docker-image" class="hash-link" aria-label="Direct link to Get an API key for pushing the docker image" title="Direct link to Get an API key for pushing the docker image">​</a></h3><p>Use the <code>trussworksbot</code> user credentials in 1Password to log into <a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer">Docker Hub</a> (you may have
to log out of your personal user session). In the <a href="https://hub.docker.com/settings/security" target="_blank" rel="noopener noreferrer">Security Settings</a>
for <code>trussworksbot</code> create a &quot;New Access Token&quot; named for the repository you just created. Save this access key to
the <code>trussworksbot</code> 1Password as you will need it later for configuring CircleCI or GitHub Actions.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-goreleaser-configuration">Create goreleaser configuration<a href="#create-goreleaser-configuration" class="hash-link" aria-label="Direct link to Create goreleaser configuration" title="Direct link to Create goreleaser configuration">​</a></h2><p>Create a <code>.goreleaser.yml</code> file and commit it.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-goreleaseryml">Example .goreleaser.yml<a href="#example-goreleaseryml" class="hash-link" aria-label="Direct link to Example .goreleaser.yml" title="Direct link to Example .goreleaser.yml">​</a></h3><p>This has some decent build defaults. This will get dependencies from go.mod then build for both OSX and Linux.
Goreleaser will also update the release in GitHub with the artifacts it builds.
It will also push to a brew tap. Build a Docker container but skip shipping to it.</p><p>Note: I had to add <code>CGO_ENABLED=0</code> so the linux binary would work in Docker.</p><p>If you don&#x27;t need to build a Docker container, just remove the docker stanza.</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token key atrule" style="color:#728fcb">env</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> GO111MODULE=auto</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token key atrule" style="color:#728fcb">before</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token key atrule" style="color:#728fcb">hooks</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> go mod download</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token key atrule" style="color:#728fcb">builds</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">env</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> CGO_ENABLED=0</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">goos</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> darwin</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> linux</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">goarch</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> amd64</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">main</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> main.go</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token key atrule" style="color:#728fcb">brews</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">description</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">&quot;USE THE DESCRIPTION FROM THE GITHUB REPO&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">github</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token key atrule" style="color:#728fcb">owner</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> trussworks</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token key atrule" style="color:#728fcb">name</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> homebrew</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">tap</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">homepage</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">&quot;https://github.com/trussworks/NEWREPO&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">commit_author</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token key atrule" style="color:#728fcb">name</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> trussworks</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">infra</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token key atrule" style="color:#728fcb">email</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> infra+github@truss.works</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token key atrule" style="color:#728fcb">dockers</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">binaries</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> &lt;BINARYNAME</span><span class="token punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">image_templates</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">&quot;OWNER/NEWREPO:{{ .Tag }}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">skip_push</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#896724;font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token key atrule" style="color:#728fcb">archives</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">replacements</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token key atrule" style="color:#728fcb">darwin</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> Darwin</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token key atrule" style="color:#728fcb">linux</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> Linux</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token key atrule" style="color:#728fcb">amd64</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> x86_64</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token key atrule" style="color:#728fcb">checksum</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token key atrule" style="color:#728fcb">name_template</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">&quot;checksums.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token key atrule" style="color:#728fcb">algorithm</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> sha256</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token key atrule" style="color:#728fcb">snapshot</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token key atrule" style="color:#728fcb">name_template</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">&quot;{{ .Tag }}-next&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token key atrule" style="color:#728fcb">changelog</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token key atrule" style="color:#728fcb">sort</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> asc</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token key atrule" style="color:#728fcb">filters</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">exclude</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">&quot;^docs:&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">&quot;^test:&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-goreleaser-locally">Test goreleaser locally<a href="#test-goreleaser-locally" class="hash-link" aria-label="Direct link to Test goreleaser locally" title="Direct link to Test goreleaser locally">​</a></h3><p>Validate your file with the command:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token plain">goreleaser check</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then try to build from this configuration using:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token plain">goreleaser build --snapshot --clean</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now you should have build artifacts in the <code>dist/</code> directory in your repository. This is a good time to ensure
that <code>dist/</code> is in your <code>.gitignore</code> file.</p><p>In your terminal from the root of your repo, try runing goreleaser without releasing with:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token plain">goreleaser --snapshot --skip-publish --clean</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This goes beyond the build process and tests out the parts of the releaser related to pushing artifacts.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="set-up-circleci">Set up CircleCI<a href="#set-up-circleci" class="hash-link" aria-label="Direct link to Set up CircleCI" title="Direct link to Set up CircleCI">​</a></h2><p>First log into CircleCI and go to the <a href="https://app.circleci.com/projects/project-dashboard/github/trussworks" target="_blank" rel="noopener noreferrer">Projects Dashboard</a>.
From this page you can find your repository and either select &quot;Set Up Project&quot; or &quot;Follow Project&quot;.</p><p>The next step is to write a CircleCI config file and commit it to your repo.
You will need to do some manual configuration in CircleCI to get this working.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="project-environment-variables">Project Environment Variables<a href="#project-environment-variables" class="hash-link" aria-label="Direct link to Project Environment Variables" title="Direct link to Project Environment Variables">​</a></h3><p>Configure the <code>GITHUB_TOKEN</code>, <code>DOCKER_USER</code>, and <code>DOCKER_PASS</code> environment variables from the CircleCI UI.</p><p><code>GITHUB_TOKEN</code> is used by goreleaser to update release notes and push binaries to the release on GitHub. It is also
used to update the <a href="https://github.com/trussworks/homebrew-tap" target="_blank" rel="noopener noreferrer">trussworks/homebrew-tap</a> with the new artifact
locations and checksums. In the <code>infra+github@truss.works</code> 1Password you will find an API Key named
<code>gorelreaser-homebrew-tap-token</code> which can be used for this value.</p><p><code>DOCKER_USER</code> and <code>DOCKER_PASS</code> are configured from the <code>trussworksbot</code> in 1Password. Use the API Key you configured
in an earlier step to fill out these values. This is how CircleCI will push to Docker Hub.</p><p>These values are configured at the URL <a href="https://app.circleci.com/settings/project/github/trussworks/NEWREPO/environment-variables" target="_blank" rel="noopener noreferrer">https://app.circleci.com/settings/project/github/trussworks/NEWREPO/environment-variables</a>. Replace <code>NEWREPO</code> with the name of your github repo.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="circleci-configyml-example">CircleCI config.yml example<a href="#circleci-configyml-example" class="hash-link" aria-label="Direct link to CircleCI config.yml example" title="Direct link to CircleCI config.yml example">​</a></h3><p>Add the contents of this code block to .circleci/config.yml in your repo after setting your repo up with CircleCI.</p><p>This configuration creates two CircleCI workflows <code>validate</code> and <code>release</code>.</p><p>The <code>validate</code> workflow is run on each commit to the repository or branch push.
This will run your pre-commit hooks as defined in <code>.pre-commit-config.yaml</code>.</p><p>The <code>release</code> workflow will only run on certain tag pushes to the repo.
This workflow will setup to build Docker containers then run goreleaser as defined in <code>.goreleaser.yml</code>.
After binaries and containers are built by <code>.goreleaser.yml</code> this validates the container works by running the container with its default entry point using the <code>--help</code> flag.
This should just be a sanity check that the container &quot;does the right thing&quot;.</p><p>If you are not building a Docker container, you must remove these steps in the release job:</p><ul><li><code>setup_remote_docker</code></li><li><code>Login to Docker Hub</code></li><li><code>Check Docker container</code></li><li><code>Docker push</code></li></ul><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token key atrule" style="color:#728fcb">version</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> </span><span class="token number" style="color:#063289">2.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token key atrule" style="color:#728fcb">references</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token key atrule" style="color:#728fcb">circleci-docker-primary</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> </span><span class="token important" style="font-weight:bold;color:#896724">&amp;circleci-docker-primary</span><span class="token plain"> trussworks/circleci</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">docker</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">primary</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain">99bee5627ff234eb0f31f5899628bff03df78b6d</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token key atrule" style="color:#728fcb">jobs</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token key atrule" style="color:#728fcb">validate</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">docker</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">image</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> </span><span class="token important" style="font-weight:bold;color:#896724">*circleci-docker-primary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">steps</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> checkout</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">restore_cache</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">          </span><span class="token key atrule" style="color:#728fcb">keys</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> pre</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">commit</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">dot</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">cache</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"> checksum &quot;.pre</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">commit</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">config.yaml&quot; </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">run</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">          </span><span class="token key atrule" style="color:#728fcb">name</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> Run pre</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">commit tests</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">          </span><span class="token key atrule" style="color:#728fcb">command</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> pre</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">commit run </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">all</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">files</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">save_cache</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">          </span><span class="token key atrule" style="color:#728fcb">key</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> pre</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">commit</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">dot</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">cache</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"> checksum &quot;.pre</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">commit</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">config.yaml&quot; </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">          </span><span class="token key atrule" style="color:#728fcb">paths</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> ~/.cache/pre</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">commit</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token key atrule" style="color:#728fcb">release</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">docker</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">image</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> </span><span class="token important" style="font-weight:bold;color:#896724">*circleci-docker-primary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">steps</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> checkout</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> setup_remote_docker</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">run</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> goreleaser</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">run</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">          </span><span class="token key atrule" style="color:#728fcb">name</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> Login to Docker Hub</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">          </span><span class="token key atrule" style="color:#728fcb">command</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> docker login </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">u $DOCKER_USER </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">p $DOCKER_PASS</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">run</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">          </span><span class="token key atrule" style="color:#728fcb">name</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> Test that Docker container works</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">          </span><span class="token key atrule" style="color:#728fcb">command</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> docker run </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">it OWNER/NEWREPO</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain">&lt;&lt; pipeline.git.tag </span><span class="token punctuation" style="color:#b6ad9a">&gt;</span><span class="token punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain">help</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">run</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">          </span><span class="token key atrule" style="color:#728fcb">name</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> Docker push</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">          </span><span class="token key atrule" style="color:#728fcb">command</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> docker push OWNER/NEWREPO</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain">&lt;&lt; pipeline.git.tag </span><span class="token punctuation" style="color:#b6ad9a">&gt;</span><span class="token punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token key atrule" style="color:#728fcb">workflows</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token key atrule" style="color:#728fcb">version</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> </span><span class="token number" style="color:#063289">2.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token key atrule" style="color:#728fcb">validate</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">jobs</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> validate</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token key atrule" style="color:#728fcb">release</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token key atrule" style="color:#728fcb">jobs</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#728fcb">release</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">          </span><span class="token key atrule" style="color:#728fcb">filters</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token key atrule" style="color:#728fcb">branches</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">              </span><span class="token key atrule" style="color:#728fcb">ignore</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> /^.</span><span class="token important" style="font-weight:bold;color:#896724">*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token key atrule" style="color:#728fcb">tags</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">              </span><span class="token key atrule" style="color:#728fcb">only</span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"> /^v</span><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token plain">0</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token number" style="color:#063289">9</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token plain">+(\.</span><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token plain">0</span><span class="token punctuation" style="color:#b6ad9a">-</span><span class="token number" style="color:#063289">9</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token plain">+)</span><span class="token important" style="font-weight:bold;color:#896724">*(-.*)*/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-a-release-from-github">Run a release from GitHub<a href="#run-a-release-from-github" class="hash-link" aria-label="Direct link to Run a release from GitHub" title="Direct link to Run a release from GitHub">​</a></h3><p>Cut a release from <code>main</code> with a tag using semantic versioning in the style of <code>v0.0.0</code> using:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token plain">git tag v0.0.0</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">git push --tags</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will create a tag and CircleCI will automatically run the <code>release</code> workflow. This will work even on
a branch, meaning you can test the release process before merging this code into the mainline branch.</p><p>You can also cut a release from the <code>https://github.com/trussworks/$REPO/releases</code> view.</p><p>And if CLI is more your thing, you can cut a release with <code>gh release create v0.0.0 --title &quot;My First Release&quot; --notes &quot;Notes go here&quot;</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="verify-the-release">Verify the release<a href="#verify-the-release" class="hash-link" aria-label="Direct link to Verify the release" title="Direct link to Verify the release">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="verify-you-can-install-from-your-configured-homebrew-tap">Verify you can install from your configured Homebrew Tap<a href="#verify-you-can-install-from-your-configured-homebrew-tap" class="hash-link" aria-label="Direct link to Verify you can install from your configured Homebrew Tap" title="Direct link to Verify you can install from your configured Homebrew Tap">​</a></h3><p>First see if your tool appears in the <a href="https://github.com/trussworks/homebrew-tap" target="_blank" rel="noopener noreferrer">trussworks/homebrew-tap</a> repo.
There should be a Ruby file with your tool&#x27;s name. If it is there then proceed to install it.</p><p>Install the Trussworks tap to homebrew and then install the tool you built.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token plain">brew tap trussworks/tap</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">brew install tool-name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Test your tool by using the help command:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token plain">tool-name -h</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">tool-name version</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Verify the version matches the release version.</p><p>Be sure you updated the <code>README.md</code> in the new tool repo to have installation instructions.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="verify-you-can-install-from-docker-hub">Verify you can install from docker hub<a href="#verify-you-can-install-from-docker-hub" class="hash-link" aria-label="Direct link to Verify you can install from docker hub" title="Direct link to Verify you can install from docker hub">​</a></h3><p>You will want to verify that your docker image was pushed to Docker Hub. Try pulling the image and running from
the container:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token plain">docker pull trussworks/tool-name:v0.0.0</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">docker run -it trussworks/tool-name:v0.0.0 --help</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">docker run -it trussworks/tool-name:v0.0.0 version</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="broadcast-this-to-others">Broadcast this to others<a href="#broadcast-this-to-others" class="hash-link" aria-label="Direct link to Broadcast this to others" title="Direct link to Broadcast this to others">​</a></h2><p>Be sure you let other folks know you broke this out for them to use and contribute to! Consider doing one of these to help get more eyes on your new tool repo:</p><ul><li>Add the people you worked with on this tool to your PRs on this repo.</li><li>Add some documentation to your repo and send the repo to Trussels in Slack!</li><li>Do a demo for your team or other teams or as an OTT.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/trussworks/Engineering-Playbook/edit/main/docs/developing/command-line-tools/HOW2GORELEASER.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/developing/command-line-tools"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Command Line Tools</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/developing/command-line-tools/direnv"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">direnv</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#install-goreleaser" class="table-of-contents__link toc-highlight">Install GoReleaser</a></li><li><a href="#split-a-tool-out-from-an-existing-project" class="table-of-contents__link toc-highlight">Split a tool out from an existing project</a></li><li><a href="#get-the-project-building-binaries" class="table-of-contents__link toc-highlight">Get the project building binaries</a><ul><li><a href="#generate-a-gomod-file" class="table-of-contents__link toc-highlight">Generate a <code>go.mod</code> file</a></li></ul></li><li><a href="#add-pre-commit-hooks" class="table-of-contents__link toc-highlight">Add pre-commit hooks</a><ul><li><a href="#example-pre-commit-configyaml-and-markdownlintrc" class="table-of-contents__link toc-highlight">Example .pre-commit-config.yaml and .markdownlintrc</a></li></ul></li><li><a href="#create-docker-configuration" class="table-of-contents__link toc-highlight">Create Docker configuration</a><ul><li><a href="#example-dockerfile" class="table-of-contents__link toc-highlight">Example Dockerfile</a></li></ul></li><li><a href="#create-a-docker-repo" class="table-of-contents__link toc-highlight">Create a Docker repo</a><ul><li><a href="#create-a-docker-hub-repo" class="table-of-contents__link toc-highlight">Create a Docker Hub repo</a></li><li><a href="#get-an-api-key-for-pushing-the-docker-image" class="table-of-contents__link toc-highlight">Get an API key for pushing the docker image</a></li></ul></li><li><a href="#create-goreleaser-configuration" class="table-of-contents__link toc-highlight">Create goreleaser configuration</a><ul><li><a href="#example-goreleaseryml" class="table-of-contents__link toc-highlight">Example .goreleaser.yml</a></li><li><a href="#test-goreleaser-locally" class="table-of-contents__link toc-highlight">Test goreleaser locally</a></li></ul></li><li><a href="#set-up-circleci" class="table-of-contents__link toc-highlight">Set up CircleCI</a><ul><li><a href="#project-environment-variables" class="table-of-contents__link toc-highlight">Project Environment Variables</a></li><li><a href="#circleci-configyml-example" class="table-of-contents__link toc-highlight">CircleCI config.yml example</a></li><li><a href="#run-a-release-from-github" class="table-of-contents__link toc-highlight">Run a release from GitHub</a></li></ul></li><li><a href="#verify-the-release" class="table-of-contents__link toc-highlight">Verify the release</a><ul><li><a href="#verify-you-can-install-from-your-configured-homebrew-tap" class="table-of-contents__link toc-highlight">Verify you can install from your configured Homebrew Tap</a></li><li><a href="#verify-you-can-install-from-docker-hub" class="table-of-contents__link toc-highlight">Verify you can install from docker hub</a></li></ul></li><li><a href="#broadcast-this-to-others" class="table-of-contents__link toc-highlight">Broadcast this to others</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://6130eb5cde15830007fdf57b--docusaurus-2.netlify.app/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docusaurus Official Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright 2023 TrussWorks, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.06f11dc9.js"></script>
<script src="/assets/js/main.1bc8baa5.js"></script>
</body>
</html>