<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-infrasec/aws/govcloud/gov-acm">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<title data-rh="true">ACM in GovCloud | Truss Engineering Playbook</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://playbook.truss.dev/docs/infrasec/aws/govcloud/gov-acm"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ACM in GovCloud | Truss Engineering Playbook"><meta data-rh="true" name="description" content="AWS Certificate Manager (ACM) is our preferred way to handle certificates"><meta data-rh="true" property="og:description" content="AWS Certificate Manager (ACM) is our preferred way to handle certificates"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://playbook.truss.dev/docs/infrasec/aws/govcloud/gov-acm"><link data-rh="true" rel="alternate" href="https://playbook.truss.dev/docs/infrasec/aws/govcloud/gov-acm" hreflang="en"><link data-rh="true" rel="alternate" href="https://playbook.truss.dev/docs/infrasec/aws/govcloud/gov-acm" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.65fa2b0f.css">
<link rel="preload" href="/assets/js/runtime~main.5226f633.js" as="script">
<link rel="preload" href="/assets/js/main.ff685db7.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/truss-icon-light.png" alt="Truss Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/truss-icon-light.png" alt="Truss Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Engineering Playbook</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/trussworks/Engineering-Playbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">Engineering Playbook</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/compliance">Federal Compliance</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/developing">Tools and Practice</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tools and Practice&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/documentation">Documentation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Documentation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/incident-response">Incident Response</a><button aria-label="Toggle the collapsible sidebar category &#x27;Incident Response&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/infrasec">InfraSec</a><button aria-label="Toggle the collapsible sidebar category &#x27;InfraSec&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/infrasec/alert-providers">Alert Providers</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/infrasec/ansible">Ansible</a><button aria-label="Toggle the collapsible sidebar category &#x27;Ansible&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/infrasec/aws">AWS</a><button aria-label="Toggle the collapsible sidebar category &#x27;AWS&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/infrasec/aws/aws-organizations">AWS Organizations</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/infrasec/aws/govcloud">Working in GovCloud</a><button aria-label="Toggle the collapsible sidebar category &#x27;Working in GovCloud&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/infrasec/aws/govcloud/gov-acm">ACM in GovCloud</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/infrasec/aws/govcloud/gov-orgs">Setting Up a GovCloud Organization</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/infrasec/aws/guardduty">GuardDuty for Organizations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/infrasec/aws/naming">Naming</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/infrasec/aws/org-bootstrap">Bootstrapping an AWS Organization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/infrasec/aws/sns-guardduty-alert-integrations">Using SNS, GuardDuty, and External Integrations with AWS Organizations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/infrasec/aws/sns-topics">SNS Topics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/infrasec/aws/vpcs">VPC Configuration</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/infrasec/book-club">Book Club</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/infrasec/bootstrap">Project Bootstrap Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/infrasec/certs">SSL Certificates</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/infrasec/charter">InfraSec Practice Charter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/infrasec/good-infra">Good Infrastructure - A Philosophy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/infrasec/pro-dev">Professional Development</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/infrasec/teardown">Project Teardown Guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/infrasec/terraform">Terraform</a><button aria-label="Toggle the collapsible sidebar category &#x27;Terraform&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/infrasec/tutorials">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/leadership">Leadership</a><button aria-label="Toggle the collapsible sidebar category &#x27;Leadership&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/practices">Engineering Practices</a><button aria-label="Toggle the collapsible sidebar category &#x27;Engineering Practices&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/templates">Templates</a><button aria-label="Toggle the collapsible sidebar category &#x27;Templates&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/web">Web Development</a><button aria-label="Toggle the collapsible sidebar category &#x27;Web Development&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/">🏠</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/infrasec"><span itemprop="name">InfraSec</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/infrasec/aws"><span itemprop="name">AWS</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/infrasec/aws/govcloud"><span itemprop="name">Working in GovCloud</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">ACM in GovCloud</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>ACM in GovCloud</h1><p>AWS Certificate Manager (ACM) is our preferred way to handle certificates
in AWS whenever possible. Unfortunately, due to the fact that Route53
cannot create public DNS entries in GovCloud, the modules which create
ACM certificates and validate them with DNS will not work. This means the
process of creating these certificates becomes slightly more complicated.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-problem-acm-dns-validation">The problem: ACM DNS validation<a class="hash-link" href="#the-problem-acm-dns-validation" title="Direct link to heading">​</a></h2><p>In both the Truss and <code>terraform-aws-modules</code> ACM module, the module
attempts to create three resources:</p><ul><li>the ACM certificate</li><li>the Route53 DNS entry to validate the certificate</li><li>the Terraform <a href="https://www.terraform.io/docs/providers/aws/r/acm_certificate_validation.html" target="_blank" rel="noopener noreferrer"><code>aws_acm_certificate_validation</code></a> resource</li></ul><p>It&#x27;s important to note that the <code>aws_acm_certificate_validation</code> resource
does not actually represent a real AWS resource -- it is an internal
mechanism Terraform uses to correctly order the creation of resources
dependent on a valid Terraform certificate. It is <em>not required</em> to
actually validate an ACM certificate.</p><p>However, the problem that the <code>aws_acm_certificate_validation</code> resource
was designed to solve -- preventing Terraform from trying to use an
invalid certificate on another resource, like an ALB -- still exists in
GovCloud. The ACM certificate resource itself <em>cannot be used</em> until it
has been validated. This means trying to create an ALB using an certificate
that has not yet been validated will fail, and in GovCloud, this creates
a timing issue, because we need to create the certificate to get the
DNS validation information, but we have to create the DNS entry in the
commercial organization before we can use it elsewhere in GovCloud.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-solution-step-by-step-creation">The solution: step-by-step creation<a class="hash-link" href="#the-solution-step-by-step-creation" title="Direct link to heading">​</a></h2><p>We can solve this by using a step-by-step creation method for our systems
which require ACM certificates. We recommend <em>not</em> creating these
certificates inside modules for your application, but instead providing
the certificate as a parameter that resources in your module can use, as
anything contingent on the successful creation of the certificate will fail
on your first apply of the module if you do include it.</p><p>To do this, here&#x27;s some sample code for the creation of the ACM certificate
in our GovCloud account:</p><div class="codeBlockContainer_I0IT language-hcl theme-code-block"><div class="codeBlockContent_wNvx" style="background-color:#faf8f5;color:#728fcb"><pre tabindex="0" class="prism-code language-hcl codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#728fcb"><span class="token plain">resource &quot;aws_acm_certificate&quot; &quot;acm_myapp&quot; {</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  domain_name       = &quot;myapp.example.com&quot;</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  validation_method = &quot;DNS&quot;</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  tags = {</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    Name        = &quot;myapp.example.com&quot;</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    Automation  = &quot;Terraform&quot;</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  lifecycle {</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    create_before_destroy = true</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">}</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">output &quot;myapp_cert_validation&quot; {</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  description = &quot;Map of data for myapp cert validation&quot;</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  value       = aws_acm_certificate.acm_myapp.domain_validation_options</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>The output is necessary because this is what will provide us the information
we need to create the validation DNS entry in our commercial AWS account. It
will look like this:</p><div class="codeBlockContainer_I0IT language-terraform theme-code-block"><div class="codeBlockContent_wNvx" style="background-color:#faf8f5;color:#728fcb"><pre tabindex="0" class="prism-code language-terraform codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#728fcb"><span class="token plain">testing_cert_validation = [</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    &quot;domain_name&quot; = &quot;myapp.example.com&quot;</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    &quot;resource_record_name&quot; = &quot;_42ef3fd691a332acfe219f37910eee14.myapp.example.com.&quot;</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    &quot;resource_record_type&quot; = &quot;CNAME&quot;</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    &quot;resource_record_value&quot; = &quot;_31d89bcda5baf24c2518526a81f86617.tfmgdnztqk.acm-validations.aws.&quot;</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>We can then take that output and create a DNS entry in our commercial DNS
account with this code:</p><div class="codeBlockContainer_I0IT language-hcl theme-code-block"><div class="codeBlockContent_wNvx" style="background-color:#faf8f5;color:#728fcb"><pre tabindex="0" class="prism-code language-hcl codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#728fcb"><span class="token plain">resource &quot;aws_route53_record&quot; &quot;myapp_acm_validation&quot; {</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  zone_id = aws_route53_zone.myzone.zone_id</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  name    = &quot;_42ef3fd691a332acfe219f37910eee14.myapp.example.com.&quot;</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  type    = &quot;CNAME&quot;</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  records = [&quot;_31d89bcda5baf24c2518526a81f86617.tfmgdnztqk.acm-validations.aws.&quot;]</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  ttl     = 60</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Once this entry has been created, you should be able to use your certificate
on other resources within a minute or two. If you want to confirm that the
certificate has been validated, you can run these commands in the GovCloud
account:</p><div class="codeBlockContainer_I0IT language-console theme-code-block"><div class="codeBlockContent_wNvx" style="background-color:#faf8f5;color:#728fcb"><pre tabindex="0" class="prism-code language-console codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#728fcb"><span class="token plain">$ aws acm list-certificates</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">{</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    &quot;CertificateSummaryList&quot;: [</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            &quot;CertificateArn&quot;: &quot;arn:aws:acm:us-west-2:000123456789:certificate/78dca028-1812-4fa5-9c84-b92fdeadbeef&quot;,</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            &quot;DomainName&quot;: &quot;myapp.example.com&quot;</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">}</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">$ aws acm describe-certificate --certificate-arn &quot;arn:aws:acm:us-west-2:000123456789:certificate/78dca028-1812-4fa5-9c84-b92fdeadbeef&quot;</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">{</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    &quot;Certificate&quot;: {</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        &quot;CertificateArn&quot;: &quot;arn:aws:acm:us-west-2:000123456789:certificate/78dca028-1812-4fa5-9c84-b92fdeadbeef&quot;,</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        &quot;DomainName&quot;: &quot;myapp.example.com&quot;,</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        &quot;SubjectAlternativeNames&quot;: [</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            &quot;myapp.example.com&quot;</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        &quot;DomainValidationOptions&quot;: [</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                &quot;DomainName&quot;: &quot;myapp.example.com&quot;,</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                &quot;ValidationDomain&quot;: &quot;myapp.example.com&quot;,</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                &quot;ValidationStatus&quot;: &quot;SUCCESS&quot;,</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>If your <code>ValidationStatus</code> is <code>SUCCESS</code>, your certificate should be ready to go.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/trussworks/Engineering-Playbook/edit/main/docs/infrasec/aws/govcloud/gov-acm.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/infrasec/aws/govcloud"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Working in GovCloud</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/infrasec/aws/govcloud/gov-orgs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Setting Up a GovCloud Organization</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-problem-acm-dns-validation" class="table-of-contents__link toc-highlight">The problem: ACM DNS validation</a></li><li><a href="#the-solution-step-by-step-creation" class="table-of-contents__link toc-highlight">The solution: step-by-step creation</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items"><li class="footer__item"><a href="https://6130eb5cde15830007fdf57b--docusaurus-2.netlify.app/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docusaurus Official Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright 2022 TrussWorks, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.5226f633.js"></script>
<script src="/assets/js/main.ff685db7.js"></script>
</body>
</html>